<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>城市综合管理服务平台</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <th:block th:include="page/fragments/common :: common_css"/>
    <th:block th:include="page/fragments/common :: bootstrap_table_css"/>
    <link rel="stylesheet" th:href="@{/css/home.css}"/>
    <style>
        .page-list {display: none !important;}
        td {border: 1px #ccc solid !important;}
        .charts span {margin-left: 10px}
        .pagination {margin-right: 10px}
        .pagination-detail {margin-top: 10px !important;}
        .pagination-info {display: none !important;}
        .matter .content .matter-content .matter-list li .matter-time {width: 46px}
        .rows h2, .rows h5 {color: #fff;margin-bottom: 10px}
    </style>
</head>
<body>
    <div id="areascontent">
        <div class="rows" style="margin-bottom: 0.8%; overflow: hidden;">
            <div style="float: left; width: 100%;">
                <div  style="height: 98vh;width:100%;position: relative; border: 1px solid #e6e6e6; overflow: hidden;">
                    <div class="warps" style="height: 60%">
                        <div class="vneterBox" >
                            <div class="manner">
                                <div class="block">
                                    <img th:src="@{/img/ground2.png}" alt="">
                                    <div class="test1">上报数</div>
                                    <div class="test2" id="report">80</div>
                                    <div class="test3">本周</div>
                                </div>
                                <div class="block">
                                    <img th:src="@{/img/ground3.png}" alt="">
                                    <div class="test1">立案数</div>
                                    <div class="test2" id="inst">180</div>
                                    <div class="test3">本周</div>
                                </div>
                            </div>
                            <!--                        表格处-->

                                <div class="mannertable autotable">
                                    <table class="table" >
                                        <thead>
                                        <tr>
                                            <th>部件</th>
                                            <th>本周</th>
                                            <th>本月</th>
                                            <th>总数</th>
                                        </tr>
                                        </thead>
                                        <tbody id="unitCount">


                                        </tbody>
                                    </table>
                                </div>

                        </div>
                        <div class="vneterBox">
                            <div class="manner">
                                <div class="block">
                                    <img th:src="@{/img/ground33.png}" alt="">
                                    <div class="test1">派遣数</div>
                                    <div class="test2" id="dispatch">90</div>
                                    <div class="test3">本周</div>
                                </div>
                                <div class="block">
                                    <img th:src="@{/img/ground4.png}" alt="">
                                    <div class="test1">结案数</div>
                                    <div class="test2" id="close">20</div>
                                    <div class="test3">本周</div>
                                </div>
                            </div>
                            <!--                        表格处-->
                            <div class="mannertable autotable">
                                <table class="table">
                                    <thead>
                                    <tr>
                                        <th>事件</th>
                                        <th>本周</th>
                                        <th>本月</th>
                                        <th>总数</th>
                                    </tr>
                                    </thead>
                                    <tbody id="eventCount">


                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="vneterBox">
                            <div class="manner userManner">
                                <div class="userBox">
                                    <div class="headImg">
                                        <div class="headerImg">
                                            <img th:src="@{/img/header.png}" alt="">
                                        </div>
                                    </div>
                                    <div class="username">
                                        <div class="adminName" th:sec:authentication="principal.name"></div>
                                    </div>
                                    <div class="purpose">
                                        <div class="book">
                                            <div class="bookBox">
                                                <img th:src="@{/img/self.png}" alt="">
                                                <div class="bookText" >用户</div>
                                            </div>
                                        </div>
                                        <div class="book">
                                            <div class="bookBox">
                                                <img th:src="@{/img/password1.png}" alt="">
                                                <div class="bookText" >密码</div>
                                            </div>
                                        </div>
                                        <div class="book">
                                            <div class="bookBox">
                                                <img th:src="@{/img/list.png}" alt="">
                                                <div class="bookText" >通讯</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
<!--                                                    表格处-->
                            <div class="mannertable">
                                <table class="table">
                                    <div class="mation mationTitle">
                                        个人信息
                                    </div>
                                    <div class="mation">
                                        <div style="float:left;font-size: 16px;color: #131313;">角色信息</div>
                                        <div style="float: right;color: #666666;font-size: 16px" id="roleName"></div>
                                    </div>
                                    <div class="mation">
                                        <div style="float:left;font-size: 16px;color: #131313;">岗位案件数</div>
                                        <div style="float: right;color: #666666;font-size: 16px" id="takeCase"></div>
                                    </div>
                                    <div class="mation">
                                        <div style="float:left;font-size: 16px;color: #131313;">办理案件数</div>
                                        <div style="float: right;color: #666666;font-size: 16px" id="instCase"></div>
                                    </div>
                                    <div class="mation">
                                        <div style="float:left;font-size: 16px;color: #131313;">完结案件数</div>
                                        <div style="float: right;color: #666666;font-size: 16px" id="closeCase"></div>
                                    </div>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="warpsOther" style="height: 39%">
                        <div class="col-md-12 bottomInner">
                            <div class="innerTop">
                                <div class="buck">待办事项</div>

                            </div>
                            <div class="innerBottom">
                                <div class="zara tiaoActive">
                                    <table id="bootstrap-table" class="table_style" style="margin: 0 auto"></table>
                                </div>

                            </div>

                        </div>

                    </div>
                </div>
            </div>

        </div>



<!--        <div class="e_chart">-->
<!--            <div class="charts l_left">-->
<!--                <p class="charts_p">全年危险品计划量和实际需求量分析<span class="r_right"></span></p>-->
<!--                <div id="salesProportion" style="height:350px;width: 98%"></div>-->
<!--            </div>-->
<!--            <div class="charts l_left last_charts">-->
<!--                <p class="charts_p">全年事故分析走势图<span class="r_right"></span></p>-->
<!--                <div id="profitProportion" style="height:350px;width: 98%"></div>-->
<!--            </div>-->
<!--            <div class="clear"></div>-->
<!--        </div>-->


<!--        <div class="article half notice">-->
<!--            <div class="wrap-l">-->
<!--                <div class="title ue-clear">-->
<!--                    <h2>值班周报</h2>-->
<!--                    <a href="javascript:;" class="more">更多</a>-->
<!--                </div>-->
<!--                <div class="content">-->
<!--                    <ul class="notice-list">-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">210期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">209期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">208期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">207期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">206期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">205期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                        <li class="ue-clear">-->
<!--                            <a href="javascript:;" class="notice-title">204期值班周报信息。</a>-->
<!--                            <div class="notice-time">9-18</div>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="article half matter" style="margin-bottom: 14px">-->
<!--            <div class="wrap-r">-->
<!--                <div class="title ue-clear">-->
<!--                    <h2 class="title-list">-->
<!--                        <ul class="ue-clear">-->
<!--                            <li class="current"><a href="javascript:;">待办事项</a></li>-->
<!--                            <li><a href="javascript:;">已办事项</a></li>-->
<!--                        </ul>-->
<!--                    </h2>-->
<!--                    <a href="javascript:;" class="more">更多</a>-->
<!--                </div>-->
<!--                <div class="content">-->
<!--                    <div class="matter-content current ue-clear">-->
<!--                        <div class="today">-->
<!--                            <p class="year">2017年9月</p>-->
<!--                            <p class="date">19</p>-->
<!--                        </div>-->
<!--                        <ul class="matter-list">-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-19</span>-->
<!--                                <a href="javascript:;" class="matter-title">下午2点召开2017年9月的工作会议</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-19</span>-->
<!--                                <a href="javascript:;" class="matter-title">上交本年度下月的工作报告提纲</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-19</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加危险品使用加强的方案会议</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-19</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加危险品预防措施大会</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-19</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加市政府举办的互动活动并宣传单位</a>-->
<!--                            </li>-->

<!--                        </ul>-->
<!--                    </div>-->
<!--                    <div class="matter-content ue-clear">-->
<!--                        <div class="today">-->
<!--                            <p class="year">2017年9月</p>-->
<!--                            <p class="date">15</p>-->
<!--                        </div>-->
<!--                        <ul class="matter-list">-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-15</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加市政府举办的互动活动并宣传单位</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-15</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加危险品预防措施大会</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-15</span>-->
<!--                                <a href="javascript:;" class="matter-title">参加危险品使用加强的方案会议</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-15</span>-->
<!--                                <a href="javascript:;" class="matter-title">上交本年度下月的工作报告提纲</a>-->
<!--                            </li>-->
<!--                            <li class="ue-clear">-->
<!--                                <span class="matter-time">9-15</span>-->
<!--                                <a href="javascript:;" class="matter-title">下午2点召开2017年9月的工作会议</a>-->
<!--                            </li>-->
<!--                        </ul>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--        </div>-->
<!--        <div class="clear"></div>-->
    </div>
</body>
<th:block th:include="page/fragments/common :: common_js"/>
<th:block th:include="page/fragments/common :: bootstrap_table_js"/>
<script type="text/javascript" th:inline="javascript">
    function getCase() {
        $.ajaxUtil.get("/statistics/personInfo", function (e) {
            console.log(e)
            $("#roleName").html(e.data[0]);
            $("#takeCase").html(e.data[1]);
            $("#instCase").html(e.data[2]);
            $("#closeCase").html(e.data[3]);
        });
    }
    $(function () {
        getCase()

    queryUserList()

        $(".star").click(function () {
            $(this).addClass("staractive").siblings(".star").removeClass("staractive");
            $(".zara").eq($(this).index(".star")).addClass("tiaoActive").siblings(".zara").removeClass("tiaoActive");
            // $(".tiao").eq($(this).index(".star")).addClass("tiaoActive").siblings(".tiao").removeClass("tiaoActive");
            $(this).children(".tiao").addClass("tiaoActive").parent(".star").siblings('.star').children(".tiao").removeClass("tiaoActive");
        })
        $(".innerBottom").height($(".bottomInner").height() - $(".innerTop").height() - 20);

        getIndexValueByWeek();
        unitCount();
        eventCount();

    });

    let getIndexValueByWeekUrl = /*[[@{/home/getIndexValueByWeek}]]*/ "/home/getIndexValueByWeek";

    function getIndexValueByWeek() {
        $.ajaxUtil.get(getIndexValueByWeekUrl, function (e) {
            $("#report").text(e.data.report);
            $("#inst").text(e.data.inst);
            $("#dispatch").text(e.data.dispatch);
            $("#close").text(e.data.close);
        });
    }

    let unitCountUrl = /*[[@{/home/unitCount}]]*/ "/home/unitCount";
    function unitCount() {
        $.ajaxUtil.get(unitCountUrl, function (e) {
            var html = "";
            $(e.data).each(function (index,value) {
                html+="<tr> <td>"+value.typeName+"</td>" +
                    "<td>"+value.weekCount+"</td>" +
                    "<td>"+value.monthCount+"</td>" +
                    "<td>"+value.count+"</td></tr>"
            })
            $("#unitCount").empty();
            $("#unitCount").append(html);
        });
    }

    let eventCountUrl = /*[[@{/home/eventCount}]]*/ "/home/eventCount";
    function eventCount() {
        $.ajaxUtil.get(eventCountUrl, function (e) {
            var html = "";
            $(e.data).each(function (index,value) {
                html+="<tr> <td>"+value.typeName+"</td>" +
                    "<td>"+value.weekCount+"</td>" +
                    "<td>"+value.monthCount+"</td>" +
                    "<td>"+value.count+"</td></tr>"
            })
            $("#eventCount").empty();
            $("#eventCount").append(html);
        });
    }

    let findEventConditionByEventTypeUrl = /*[[@{/event/findEventConditionByEventType}]]*/ "/event/findEventConditionByEventType";
    let showUrl = [[${@fastProperties.nginxUrl}]];
    let uploadUrl = /*[[@{/common/uploads}]]*/ "/json/unit.json";
    let img = /*[[@{/common/img/}]]*/ "/common/img/";
    let event = /*[[@{/event/findOne}]]*/ "/event/findOne";
    let getNodeNameUrl = /*[[@{/event/getNodeName}]]*/ "/event/getNodeName";
    let getGridPolygonUrl = /*[[@{/event/getGridPolygon}]]*/ "/event/getGridPolygon";
    let searchUrl = /*[[@{/home/eventListByToDoWithIndex}]]*/ "/home/eventListByToDoWithIndex";
    let addUrl = /*[[@{/event/toSupervisionAcceptanceSave}]]*/ "/user/add";
    let removeUrl = /*[[@{/user/remove}]]*/ "/user/remove";
    let completeByReceptionistUrl = /*[[@{/event/completeByReceptionistWithSendVerification}]]*/ "/event/completeByReceptionistWithSendVerification";
    let claimAndCompleteByReceptionistUrl = /*[[@{/event/claimAndCompleteByReceptionistWithShiftLeader}]]*/ "/event/claimAndCompleteByReceptionistWithShiftLeader";
    let completeByReceptionistWithSendCheckUrl = /*[[@{/event/completeByReceptionistWithSendCheck}]]*/ "/event/completeByReceptionistWithSendCheck";
    let statisticsByEventIdUrl = /*[[@{/statistics/byEventId}]]*/ "/statistics/byEventId";
    let editUrl = /*[[@{/user/toSupervisionAcceptanceUpdate/{id}}]]*/ "/user/remove";


    let num = 1;

    function queryUserList() {
        var options = {
            num: num,
            showRefresh: false,
            showColumns: false,
            showToggle: false,
            url: searchUrl,
            createUrl: addUrl,
            updateUrl: editUrl,
            removeUrl: removeUrl,
            // exportUrl: prefix + "/export",
            // importUrl: prefix + "/importData",
            // importTemplateUrl: prefix + "/importTemplate",
            uniqueId: "id",
            sortName: "updateTime",
            sortOrder: "desc",
            modalName: "用户",
            onClickRow: function (row, index) {
                console.log(row,index)
                //跳转
                window.parent.$.learuntab.myAddTab('待办事件', row.url, 'data_id')
                // window.location.href = row.url
                // checkRow(row.id);
            },
            columns: [
                {
                    field: 'index',
                    title: '序号',
                    formatter: function (value, row, index) {
                        var page = $('#bootstrap-table').bootstrapTable("getPage");
                        return page.pageSize * (page.pageNumber - 1) + index + 1;
                    }
                },
                {
                    title: '处理时限',
                    field: '',
                    formatter: setTimeLimit
                },
                {
                    title: '案件编号',
                    field: 'eventCode'
                },
                {
                    title: '问题描述',
                    field: 'represent'
                },
                {
                    title: '当前状态',
                    field: 'taskName'
                },
                {
                    title: '案件类型',
                    field: 'recTypeName'
                },
            ]
        };
        $.table.init(options);
    }
    
    // $('#table').bootstrapTable({
    //     method: "get",
    //     striped: true,
    //     singleSelect: false,
    //     url: "json/home1.json",
    //     dataType: "json",
    //     pagination: true, //分页
    //     pageSize: 8,
    //     pageNumber: 1,
    //     search: false, //显示搜索框
    //     contentType: "application/x-www-form-urlencoded",
    //     queryParams:null,
    //     columns: [
    //         {
    //             title: "危化品种类",
    //             field: 'title',
    //             align: 'center',
    //             valign: 'middle'
    //         },
    //         {
    //             title: '产量',
    //             field: 'id',
    //             align: 'center',
    //             valign: 'middle'
    //         },
    //         {
    //             title: '储存量',
    //             field: 'type',
    //             align: 'center',
    //             valign: 'middle'
    //         },
    //         {
    //             title: '同比',
    //             field: 'person',
    //             align: 'center'
    //         },
    //         {
    //             title: '环比',
    //             field: 'oper',
    //             align: 'center'
    //         }
    //     ]
    // });
    // $(".title-list ul").on("click","li",function(){
    //     var aIndex = $(this).index();
    //     $(this).addClass("current").siblings().removeClass("current");
    //     $(".matter-content").removeClass("current").eq(aIndex).addClass("current");
    // });
    // function unit() {
    //     var Name = "从业单位分析";
    //     var Href = "unit_analysis.html";
    //     var data_id = $("#add").attr('data-id');
    //     window.parent.$.learuntab.myAddTab(Name, Href, data_id);
    // }
    // function person() {
    //     var Name = "从业人员分析";
    //     var Href = "personAnalysis.html";
    //     var data_id = $("#add").attr('data-id');
    //     window.parent.$.learuntab.myAddTab(Name, Href, data_id);
    // }
    // function car() {
    //     var Name = "运输车分析";
    //     var Href = "transport_analysis.html";
    //     var data_id = $("#add").attr('data-id');
    //     window.parent.$.learuntab.myAddTab(Name, Href, data_id);
    // }
    // function wareArea() {
    //     var Name = "仓库分析";
    //     var Href = "houseAnalysis.html";
    //     var data_id = $("#add").attr('data-id');
    //     window.parent.$.learuntab.myAddTab(Name, Href, data_id);
    // }
    // function accident() {
    //     var Name = "事故分析";
    //     var Href = "accidentAnalysis.html";
    //     var data_id = $("#add").attr('data-id');
    //     window.parent.$.learuntab.myAddTab(Name, Href, data_id);
    // }

</script>
</html>
